# ============================================================================
# ä»˜éŒ² N åœ°ä¸­ç†±ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—æ¸©æ°´æš–æˆ¿æ©Ÿ
# ============================================================================

import numpy as np
from pyhees.section4_7_common import get_Q_out_H_hs_d_t
from pyhees.section4_8_a import calc_e_ref_H_th
import pyhees.section4_7_h as appendix_H
from pyhees.section4_7_o import get_virtual_HeatExchangerType


# ============================================================================
# N3. æš–æˆ¿ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡
# ============================================================================


# ============================================================================
# N.3.1 æ¶ˆè²»é›»åŠ›é‡
# ============================================================================


def calc_E_E_hs_d_t(Q_dmd_H_hs_d_t, Theta_ex_a_Ave, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_SW_d_t, q_max_hs, L_H_x_t_i, L_CS_x_t_i, L_CL_x_t_i, HeatExchangerType):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (1)

    Args:
      Q_dmd_H_hs_d_t(ndarray): 1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®ç†±éœ€è¦ (MJ/h)
      Theta_ex_a_Ave(float): å¹´å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      Theta_ex_d_Ave_d(ndarray): æ—¥ä»˜dã«ãŠã‘ã‚‹æ—¥å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      Theta_ex_H_Ave(float): æš–æˆ¿æœŸã«ãŠã‘ã‚‹æœŸé–“å¹³å‡å¤–æ°—æ¸©åº¦ï¼ˆâ„ƒï¼‰
      Theta_SW_d_t(ndarray): å¾€ãæ¸©æ°´æ¸©åº¦ (â„ƒ)
      q_max_hs(float): ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ› â’²
      L_H_x_t_i(ndarray): æš–å†·æˆ¿åŒºç”»iã®1æ™‚é–“å½“ãŸã‚Šã®æš–æˆ¿è² è·
      L_CS_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿é¡•ç†±è² è· (MJ/h)
      L_CL_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿æ½œç†±è² è· (MJ/h)
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      ndarray: 1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h)

    """
    # ---------- åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ ----------

    # 1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20c)
    L_max_C = get_L_max_C(L_CS_x_t_i, L_CL_x_t_i)

    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20b)
    L_max_H = get_L_max_H(L_H_x_t_i)

    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰(20a)
    R_L_max = get_R_L_max(L_max_H, L_max_C)

    # ä»˜éŒ²Oã«ã‚ˆã‚‹ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã®æ±ºå®š
    virtual_HeatExchangerType = get_virtual_HeatExchangerType(HeatExchangerType)

    # åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°ï¼ˆ-ï¼‰(19)
    K_gsRW_H = calc_K_gsRW_H(R_L_max, virtual_HeatExchangerType)

    # æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰(18)
    Delta_Theta_gsRW_H = calc_Delta_Theta_gsRW_H(R_L_max, virtual_HeatExchangerType)

    # æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ï¼ˆâ„ƒï¼‰(17)
    Theta_gsRW_d_ave_d = get_Theta_gsRW_d_ave_d(K_gsRW_H, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_ex_a_Ave, Delta_Theta_gsRW_H)

    # ---------- åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ› ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›ï¼ˆMJ/hï¼‰(16)
    q_max_H_hs_JRA = calc_q_max_H_hs_JRA(q_max_hs)

    # ---------- æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿå†…ã®å¹³å‡æ”¾ç†±æå¤± ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ã®ç†±æºæ©Ÿå†…éƒ¨ã®å¹³å‡æ”¾ç†±æå¤± (kw) (N.9)
    q_loss_H_hs_d_t = get_q_loss_H_hs_d_t()

    # ---------- æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ› ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›ï¼ˆMJ/hï¼‰(15)
    Q_max_H_hs_d_t = calc_Q_max_H_hs_d_t(Theta_SW_d_t, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_ex_a_Ave, q_max_hs, L_H_x_t_i, L_CS_x_t_i, L_CL_x_t_i, HeatExchangerType)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æš–æˆ¿å‡ºåŠ›ï¼ˆMJ/hï¼‰(14)
    Q_out_H_hs_d_t = get_Q_out_H_hs_d_t(Q_dmd_H_hs_d_t, Q_max_H_hs_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›(kW) (13)
    q_out_H_hs_d_t = get_q_out_H_hs_d_t(Q_out_H_hs_d_t)

    # ---------- æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡ ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-) (12)
    qr_out_H_hs_d_t = get_qr_out_H_hs_d_t(q_out_H_hs_d_t, q_max_H_hs_JRA)

    # ---------- è£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®è£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡(kWh/h) (11a)
    E_aux_hs_d_t = calc_E_aux_hs_d_t(qr_out_H_hs_d_t)

    # ---------- ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h) (10a)
    E_pump_gsRW_d_t = calc_E_pump_gsRW_d_t(qr_out_H_hs_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®é€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h) (9a)
    E_pump_SW_d_t = calc_E_pump_SW_d_t(qr_out_H_hs_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h) (8)
    E_pump_hs_d_t = get_E_pump_hs_d_t(E_pump_SW_d_t, E_pump_gsRW_d_t)

    # ---------- åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ ----------

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®å‡ç¸®æ¸©åº¦ï¼ˆâ„ƒï¼‰(7a)
    Theta_ref_SH_d_t = calc_Theta_ref_SH_d_t(qr_out_H_hs_d_t, Theta_gsRW_d_ave_d)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰(6a)
    Theta_ref_SC_d_t = calc_Theta_ref_SC_d_t(qr_out_H_hs_d_t, Theta_SW_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®å‡ç¸®æ¸©åº¦ï¼ˆâ„ƒï¼‰(5a)
    Theta_ref_cnd_d_t = calc_Theta_ref_cnd_d_t(qr_out_H_hs_d_t, Theta_SW_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰(4a)
    Theta_ref_evp_d_t = calc_Theta_ref_evp_d_t(qr_out_H_hs_d_t, Theta_gsRW_d_ave_d)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®åœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ (-) (3a)
    Mu_d_t = calc_Mu_d_t(Theta_ref_evp_d_t, Theta_ref_cnd_d_t, Theta_ref_SC_d_t, Theta_ref_SH_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h) (2)
    E_comp_hs_d_t, _ = get_E_comp_hs_d_t(qr_out_H_hs_d_t, q_out_H_hs_d_t, q_loss_H_hs_d_t, Mu_d_t, Theta_ref_evp_d_t, Theta_ref_cnd_d_t)

    # ---------- ç†±æºæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ ----------

    # 1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (kWh/h) (1)
    E_E_hs_d_t = E_comp_hs_d_t + E_pump_hs_d_t + E_aux_hs_d_t
    E_E_hs_d_t[q_out_H_hs_d_t == 0] = 0

    return E_E_hs_d_t


# ============================================================================
# N.3.2 ã‚¬ã‚¹æ¶ˆè²»é‡
# ============================================================================


def get_E_G_hs_d_t():
    """ç†±æºæ©Ÿã®ã‚¬ã‚¹æ¶ˆè²»é‡

    Args:

    Returns:
      ndarray: ç†±æºæ©Ÿã®ã‚¬ã‚¹æ¶ˆè²»é‡

    """
    return np.zeros(24 * 365)


# ============================================================================
# N.3.3 ç¯æ²¹æ¶ˆè²»é‡
# ============================================================================


def get_E_K_hs_d_t():
    """ç†±æºæ©Ÿã®ç¯æ²¹æ¶ˆè²»é‡

    Args:

    Returns:
      ndarray: ç†±æºæ©Ÿã®ç¯æ²¹æ¶ˆè²»é‡

    """
    return np.zeros(24 * 365)


# ============================================================================
# N.3.4 ãã®ä»–ã®ä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡
# ============================================================================


def get_E_M_hs_d_t():
    """ç†±æºæ©Ÿã®ãã®ä»–ã®ç‡ƒæ–™ã®ä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡

    Args:

    Returns:
      ndarray: ç†±æºæ©Ÿã®ãã®ä»–ã®ç‡ƒæ–™ã®ä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡

    """
    return np.zeros(24 * 365)


# ============================================================================
# N.4 åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡
# ============================================================================


def get_E_comp_hs_d_t(qr_out_H_hs_d_t, q_out_H_hs_d_t, q_loss_H_hs_d_t, Mu_d_t, Theta_ref_evp_d_t, Theta_ref_cnd_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (2)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      q_out_H_hs_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      q_loss_H_hs_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      Mu_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      Theta_ref_evp_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      Theta_ref_cnd_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡

    """
    # åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›ã«å¯¾ã™ã‚‹è£œæ­£ä¿‚æ•°ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°(-) (2c)
    k_comp_a = -0.7309
    k_comp_b = 0.67
    k_comp_c = 1.0319

    # æ—¥ä»˜ğ‘‘ã®æ™‚åˆ»ğ‘¡ã«ãŠã‘ã‚‹åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›ã«å¯¾ã™ã‚‹è£œæ­£ä¿‚æ•°(-) (2b)
    f_comp_act_d_t = np.clip(k_comp_a * qr_out_H_hs_d_t + (1 - k_comp_a * k_comp_b), 1, None) * k_comp_c

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®åœ§ç¸®æ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ (2a)
    E_comp_hs_d_t = f_comp_act_d_t * ((q_out_H_hs_d_t + q_loss_H_hs_d_t) / Mu_d_t)
    E_comp_hs_d_t[Theta_ref_evp_d_t >= Theta_ref_cnd_d_t] = 0

    return E_comp_hs_d_t, f_comp_act_d_t


def calc_Mu_d_t(Theta_ref_evp_d_t, Theta_ref_cnd_d_t, Theta_ref_SC_d_t, Theta_ref_SH_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹åœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ (3a)

    Args:
      Theta_ref_evp_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      Theta_ref_cnd_d_t(ndarray): 1æ™‚é–“å¹³å‡ã®ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆã®æ–­ç¶šé‹è»¢ç‡
      Theta_ref_SC_d_t(ndarray): ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éå†·å´åº¦ï¼ˆâ„ƒï¼‰
      Theta_ref_SH_d_t(ndarray): ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éç†±åº¦ï¼ˆâ„ƒï¼‰

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹åœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ (3a)

    """
    # KÎ¼h0ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)
    K_Mu_h_0 = get_K_Mu_h_0()

    # KÎ¼h1ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)
    K_Mu_h_1 = get_K_Mu_h_1()

    # KÎ¼h2ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)
    K_Mu_h_2 = get_K_Mu_h_2()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®ç†è«–æš–æˆ¿åŠ¹ç‡(-) 4ç« 8ç¯€ä»˜éŒ²A(1)
    e_ref_H_th_d_t = calc_e_ref_H_th(Theta_ref_evp_d_t, Theta_ref_cnd_d_t, Theta_ref_SC_d_t, Theta_ref_SH_d_t)

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹åœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ (3a)
    Mu_d_t = K_Mu_h_2 * (e_ref_H_th_d_t ** 2) + K_Mu_h_1 * e_ref_H_th_d_t + K_Mu_h_0
    Mu_d_t[e_ref_H_th_d_t > 10] = K_Mu_h_2 * (10 ** 2) + K_Mu_h_1 * 10 + K_Mu_h_0

    return Mu_d_t


def get_K_Mu_h_0():
    """KÎ¼h0ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    Args:

    Returns:
      float: KÎ¼h0ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    """
    return -0.430363368361459


def get_K_Mu_h_1():
    """KÎ¼h1ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    Args:

    Returns:
      float: KÎ¼h1ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    """
    return 0.698531770387591


def get_K_Mu_h_2():
    """KÎ¼h2ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    Args:

    Returns:
      float: KÎ¼h2ï¼šåœ§ç¸®æ©Ÿã®åœ§ç¸®åŠ¹ç‡ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•° (-) (3b)

    """
    return 0.0100164335768507


def calc_Theta_ref_evp_d_t(qr_out_H_hs_d_t, Theta_gsRW_d_ave_d):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰ (4a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      Theta_gsRW_d_ave_d(ndarray): æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ï¼ˆâ„ƒï¼‰

    Returns:
      æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰ (4a)

    """
    # Kevph0ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)
    K_evp_h_0 = get_K_evp_h_0()

    # Kevph1ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)
    K_evp_h_1 = get_K_evp_h_1()

    # Kevph2ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)
    K_evp_h_2 = get_K_evp_h_2()

    # Kevph12ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)
    K_evp_h_12 = get_K_evp_h_12()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰ (4a)
    Theta_ref_evp_d_t = np.clip(K_evp_h_0 + K_evp_h_1 * np.repeat(Theta_gsRW_d_ave_d, 24)
                                + K_evp_h_2 * qr_out_H_hs_d_t
                                + K_evp_h_12 * np.repeat(Theta_gsRW_d_ave_d, 24) * qr_out_H_hs_d_t, -50, None)

    return Theta_ref_evp_d_t


def get_K_evp_h_0():
    """Kevph0ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)

    Args:

    Returns:
      float: Kevph0ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """

    return -2.95315205817646


def get_K_evp_h_1():
    """Kevph1ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)

    Args:

    Returns:
      float: Kevph1ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.915893610614308


def get_K_evp_h_2():
    """Kevph2ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)

    Args:

    Returns:
      float: Kevph2ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return -11.8319776584846


def get_K_evp_h_12():
    """Kevph12ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (4b)

    Args:

    Returns:
      float: Kevph12ï¼šè’¸ç™ºæ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.29704275467947


def calc_Theta_ref_cnd_d_t(qr_out_H_hs_d_t, Theta_SW_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®å‡ç¸®æ¸©åº¦ï¼ˆâ„ƒï¼‰(5a)

    Args:
      qr_out_H_hs_d_t(param Theta_SW_d_t: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹å¾€ãæ¸©æ°´æ¸©åº¦ï¼ˆâ„ƒï¼‰): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      Theta_SW_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹å¾€ãæ¸©æ°´æ¸©åº¦ï¼ˆâ„ƒï¼‰

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®å‡ç¸®æ¸©åº¦ï¼ˆâ„ƒï¼‰

    """
    # Kcndh0ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)
    K_cnd_h_0 = get_K_cnd_h_0()

    # Kcndh1ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)
    K_cnd_h_1 = get_K_cnd_h_1()

    # Kcndh2ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)
    K_cnd_h_2 = get_K_cnd_h_2()

    # Kcndh12ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)
    K_cnd_h_12 = get_K_cnd_h_12()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®è’¸ç™ºæ¸©åº¦ï¼ˆâ„ƒï¼‰ (5a)
    Theta_ref_cnd_d_t = np.clip(K_cnd_h_0 + K_cnd_h_1 * Theta_SW_d_t
                                + K_cnd_h_2 * qr_out_H_hs_d_t
                                + K_cnd_h_12 * Theta_SW_d_t * qr_out_H_hs_d_t, None, 65)

    return Theta_ref_cnd_d_t


def get_K_cnd_h_0():
    """Kcndh0ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)

    Args:

    Returns:
      float: Kcndh0ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 3.6105623002886


def get_K_cnd_h_1():
    """Kcndh1ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)

    Args:

    Returns:
      float: Kcndh1ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.930136847064537


def get_K_cnd_h_2():
    """Kcndh2ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)

    Args:

    Returns:
      float: Kcndh2ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.494024927234563


def get_K_cnd_h_12():
    """Kcndh12ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (5b)

    Args:

    Returns:
      ndarray: Kcndh12ï¼šå‡ç¸®æ¸©åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.00770898511188855


def calc_Theta_ref_SC_d_t(qr_out_H_hs_d_t, Theta_SW_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éå†·å´åº¦ï¼ˆâ„ƒï¼‰(6a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      Theta_SW_d_t(ndarray): å¾€ãæ¸©æ°´æ¸©åº¦ (â„ƒ)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éå†·å´åº¦ï¼ˆâ„ƒï¼‰

    """
    # Ksch0ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (6b)
    K_sc_h_0 = get_K_sc_h_0()

    # Ksch1ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (6b)
    K_sc_h_1 = get_K_sc_h_1()

    # Ksch2ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (6b)
    K_sc_h_2 = get_K_sc_h_2()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éå†·å´åº¦ï¼ˆâ„ƒï¼‰ (6a)
    Theta_ref_SC_d_t = np.clip(K_sc_h_0 + K_sc_h_1 * Theta_SW_d_t + K_sc_h_2 * qr_out_H_hs_d_t, 0, None)

    return Theta_ref_SC_d_t


def get_K_sc_h_0():
    """Ksch0ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°(-) (6b)

    Args:

    Returns:
      float: Ksch0ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°(-) (6b)

    """
    return -4.02655782981397


def get_K_sc_h_1():
    """Ksch1ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (6b)

    Args:

    Returns:
      float: Ksch1ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.0894330494418674


def get_K_sc_h_2():
    """Ksch2ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (6b)

    Args:

    Returns:
      float: Ksch2ï¼šéå†·å´åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 14.3457831669162


def calc_Theta_ref_SH_d_t(qr_out_H_hs_d_t, Theta_gsRW_d_ave_d):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éç†±åº¦ï¼ˆâ„ƒï¼‰(7a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      Theta_gsRW_d_ave_d(ndarray): æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ï¼ˆâ„ƒï¼‰

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éç†±åº¦ï¼ˆâ„ƒï¼‰

    """
    # Kshh0ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (7b)
    K_sh_h_0 = get_K_sh_h_0()

    # Kshh1ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (7b)
    K_sh_h_1 = get_K_sh_h_1()

    # Kshh2ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (7b)
    K_sh_h_2 = get_K_sh_h_2()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ãƒ’ãƒ¼ãƒˆãƒãƒ³ãƒ—ã‚µã‚¤ã‚¯ãƒ«ã®éç†±åº¦ï¼ˆâ„ƒï¼‰ (7a)
    Theta_ref_SC_d_t = np.clip(K_sh_h_0 + K_sh_h_1 * qr_out_H_hs_d_t + K_sh_h_2 * np.repeat(Theta_gsRW_d_ave_d, 24), 0, None)

    return Theta_ref_SC_d_t


def get_K_sh_h_0():
    """Kshh0ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°(-) (7b)

    Args:

    Returns:
      float: Kshh0ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•°

    """
    return 0.819643791668597


def get_K_sh_h_1():
    """Kshh1ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (7b)

    Args:

    Returns:
      float: Kshh1ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 2.99282570323758


def get_K_sh_h_2():
    """Kshh2ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (7b)

    Args:

    Returns:
      Kshh2ï¼šéç†±åº¦ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return -0.0762659183765636


# ============================================================================
# N.5 ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡
# ============================================================================


def get_E_pump_hs_d_t(E_pump_SW_d_t, E_pump_gsRW_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ (8)

    Args:
      E_pump_SW_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®é€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰
      E_pump_gsRW_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰

    """

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ (8)
    E_pump_hs_d_t = E_pump_SW_d_t + E_pump_gsRW_d_t

    return E_pump_hs_d_t


def calc_E_pump_SW_d_t(qr_out_H_hs_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®é€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (9a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®é€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰

    """
    # apump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (9b)
    a_pump_SW = get_a_pump_SW()

    # bpump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (9b)
    b_pump_SW = get_b_pump_SW()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®é€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (9a)
    E_pump_SW_d_t = a_pump_SW * qr_out_H_hs_d_t + b_pump_SW * (qr_out_H_hs_d_t ** 2)

    return E_pump_SW_d_t


def get_a_pump_SW():
    """apump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (9b)

    Args:

    Returns:
      float: apump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.041972403


def get_b_pump_SW():
    """bpump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (9b)

    Args:

    Returns:
      float: bpump,SWï¼šé€æ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.104478967


def calc_E_pump_gsRW_d_t(qr_out_H_hs_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (10a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰

    """
    # apump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (10b)
    a_pump_gsRW = get_a_pump_gsRW()

    # bpump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (10b)
    b_pump_gsRW = get_b_pump_gsRW()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (10a)
    E_pump_gsRW_d_t = a_pump_gsRW * qr_out_H_hs_d_t + b_pump_gsRW * (qr_out_H_hs_d_t ** 2)

    return E_pump_gsRW_d_t


def get_a_pump_gsRW():
    """apump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (10b)

    Args:

    Returns:
      float: apump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.062196275


def get_b_pump_gsRW():
    """bpump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (10b)

    Args:

    Returns:
      bpump,gsRWï¼šç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.071756474


# ============================================================================
# N.6 è£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡
# ============================================================================


def calc_E_aux_hs_d_t(qr_out_H_hs_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®è£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (11a)

    Args:
      qr_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®è£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰

    """
    # kauxh0ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (11b)
    kauxh0 = get_kauxh0()

    # kauxh1ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (11b)
    kauxh1 = get_kauxh1()

    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ°´ãƒãƒ³ãƒ—ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰ (11a)
    E_aux_hs_d_t = kauxh1 * qr_out_H_hs_d_t + kauxh0

    return E_aux_hs_d_t


def get_kauxh0():
    """kauxh0ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (11b)

    Args:

    Returns:
      float: kauxh0ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.0433205551083371


def get_kauxh1():
    """kauxh1ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-) (11b)

    Args:

    Returns:
      float: kauxh1ï¼šè£œæ©Ÿã®æ¶ˆè²»é›»åŠ›é‡ã‚’è¨ˆç®—ã™ã‚‹å¼ã®ä¿‚æ•° (-)

    """
    return 0.0173758330059922


# ============================================================================
# N.7 æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡
# ============================================================================


def get_qr_out_H_hs_d_t(q_out_H_hs_d_t, q_max_H_hs_JRA):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡ï¼ˆ-ï¼‰ (12)

    Args:
      q_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡(-)
      q_max_H_hs_JRA(ndarray): åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡ï¼ˆ-ï¼‰

    """
    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ›ã«å¯¾ã™ã‚‹å¹³å‡è² è·ç‡ï¼ˆ-ï¼‰ (12)
    qr_out_H_hs_d_t = (q_out_H_hs_d_t * 10 ** 3) / q_max_H_hs_JRA

    return qr_out_H_hs_d_t


# ============================================================================
# N.8 æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›
# ============================================================================


def get_q_out_H_hs_d_t(Q_out_H_hs_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›ï¼ˆkWï¼‰ (13)

    Args:
      Q_out_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æš–æˆ¿å‡ºåŠ›(MJ/h)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›ï¼ˆkWï¼‰

    """
    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›ï¼ˆkWï¼‰(13)
    q_out_H_hs_d_t = Q_out_H_hs_d_t / 3600 * 10 ** 3

    return q_out_H_hs_d_t

def get_Q_out_H_hs_d_t(Q_dmd_H_hs_d_t, Q_max_H_hs_d_t):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æš–æˆ¿å‡ºåŠ›ï¼ˆMJ/hï¼‰(14)

    Args:
      Q_dmd_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æ¸©æ°´ç†±éœ€è¦(MJ/h)
      Q_max_H_hs_d_t(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›(MJ/h)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æš–æˆ¿å‡ºåŠ›ï¼ˆMJ/hï¼‰

    """
    # æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿å‡ºåŠ›ï¼ˆkWï¼‰(14)
    return np.min([Q_dmd_H_hs_d_t, Q_max_H_hs_d_t], axis=0)


def calc_Q_max_H_hs_d_t(Theta_SW_d_t, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_ex_a_Ave, q_max_hs, L_H_x_t_i, L_CS_x_t_i, L_CL_x_t_i, HeatExchangerType):
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›(MJ/h) (15)

    Args:
      Theta_SW_d_t(ndarray): å¾€ãæ¸©æ°´æ¸©åº¦ (â„ƒ)
      Theta_ex_d_Ave_d(ndarray): æ—¥ä»˜dã«ãŠã‘ã‚‹æ—¥å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      Theta_ex_H_Ave(float): æš–æˆ¿æœŸã«ãŠã‘ã‚‹æœŸé–“å¹³å‡å¤–æ°—æ¸©åº¦ï¼ˆâ„ƒï¼‰
      Theta_ex_a_Ave(float): å¹´å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      q_max_hs(float): ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ› â’²
      L_H_x_t_i(ndarray): æš–å†·æˆ¿åŒºç”»iã®1æ™‚é–“å½“ãŸã‚Šã®æš–æˆ¿è² è·
      L_CS_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿é¡•ç†±è² è· (MJ/h)
      L_CL_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿æ½œç†±è² è· (MJ/h)
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      ndarray: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›(MJ/h)

    """
    # ---------- åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ ----------

    # 1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20c)
    L_max_C = get_L_max_C(L_CS_x_t_i, L_CL_x_t_i)

    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20b)
    L_max_H = get_L_max_H(L_H_x_t_i)

    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰(20a)
    R_L_max = get_R_L_max(L_max_H, L_max_C)

    # ä»˜éŒ²Oã«ã‚ˆã‚‹ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã®æ±ºå®š
    virtual_HeatExchangerType = get_virtual_HeatExchangerType(HeatExchangerType)

    # åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°ï¼ˆ-ï¼‰(19)
    K_gsRW_H = calc_K_gsRW_H(R_L_max, virtual_HeatExchangerType)

    # æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰(18)
    Delta_Theta_gsRW_H = calc_Delta_Theta_gsRW_H(R_L_max, virtual_HeatExchangerType)

    # æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦ï¼ˆâ„ƒï¼‰(17)
    Theta_gsRW_d_ave_d = get_Theta_gsRW_d_ave_d(K_gsRW_H, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_ex_a_Ave,
                                                Delta_Theta_gsRW_H)

    # ---------- åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W) (16) ----------
    q_max_H_hs_JRA = calc_q_max_H_hs_JRA(q_max_hs)

    # ---------- æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿å‡ºåŠ›(MJ/h)(15) ----------
    Q_max_H_hs_d_t = (-0.005635139785329 * Theta_SW_d_t
                      + 0.0258983299329793 * np.clip(np.repeat(Theta_gsRW_d_ave_d, 24), 0, 20) + 0.836930642418471) * q_max_H_hs_JRA * 3600 * 10 ** (-6)

    return Q_max_H_hs_d_t


# ============================================================================
# N.9 æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿå†…ã®å¹³å‡æ”¾ç†±æå¤±
# ============================================================================


def get_q_loss_H_hs_d_t():
    """æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿå†…ã®å¹³å‡æ”¾ç†±æå¤±ï¼ˆkWï¼‰

    Args:

    Returns:
      float: æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿå†…ã®å¹³å‡æ”¾ç†±æå¤±ï¼ˆkWï¼‰

    """
    return 0


# ============================================================================
# N.10 åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›
# ============================================================================


def calc_q_max_H_hs_JRA(q_max_hs):
    """åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W) (16)

    Args:
      q_max_hs(return: åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W)): ç†±æºæ©Ÿã®æœ€å¤§æš–æˆ¿èƒ½åŠ› â’²

    Returns:
      åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W)

    """
    # åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«é–¢ã™ã‚‹æœ€å¤§æš–æˆ¿èƒ½åŠ›ã®è£œæ­£ä¿‚æ•°(-)
    f_crated = get_f_crated()

    # åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«ã‚ˆã‚‹è£œæ­£å¾Œã®æœ€å¤§æš–æˆ¿èƒ½åŠ›(W)(16)
    q_max_H_hs_JRA = q_max_hs * f_crated

    return q_max_H_hs_JRA


def calc_q_rtd_hs(region, A_A, A_MR, A_OR, mode_MR, mode_OR, has_MR_hwh, has_OR_hwh):
    """æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å®šæ ¼èƒ½åŠ›

    Args:
      region(int): çœã‚¨ãƒãƒ«ã‚®ãƒ¼åœ°åŸŸåŒºåˆ†
      A_A(float): åºŠé¢ç©ã®åˆè¨ˆ (m2)
      A_MR(float): ä¸»ãŸã‚‹å±…å®¤ã®åºŠé¢ç© (m2)
      A_OR(float): ãã®ä»–ã®å±…å®¤ã®åºŠé¢ç© (m2)
      mode_MR(str): ä¸»ãŸã‚‹å±…å®¤ã®é‹è»¢ãƒ¢ãƒ¼ãƒ‰ 'ã„', 'ã‚', 'ã¯'
      mode_OR(str): ãã®ä»–ã®å±…å®¤ã®é‹è»¢ãƒ¢ãƒ¼ãƒ‰ 'ã„', 'ã‚', 'ã¯'
      has_MR_hwh(bool): æ¸©æ°´æš–æˆ¿ã®æ”¾ç†±å™¨ã‚’ä¸»ãŸã‚‹å±…å®¤ã«è¨­ç½®ã™ã‚‹å ´åˆã¯True
      has_OR_hwh(bool): æ¸©æ°´æš–æˆ¿ã®æ”¾ç†±å™¨ã‚’ãã®ä»–ã®å±…å®¤ã«è¨­ç½®ã™ã‚‹å ´åˆã¯True

    Returns:
      float: æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®å®šæ ¼èƒ½åŠ›

    """
    # ä»˜éŒ²Hã«å®šã‚ã‚‹æ¸©æ°´æš–æˆ¿ç”¨ç†±æºæ©Ÿã®æœ€å¤§èƒ½åŠ› q_max_hs ã«ç­‰ã—ã„
    return appendix_H.calc_q_max_hs(region, A_A, A_MR, A_OR, mode_MR, mode_OR, has_MR_hwh, has_OR_hwh)


def get_f_crated():
    """åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«é–¢ã™ã‚‹æœ€å¤§æš–æˆ¿èƒ½åŠ›ã®è£œæ­£ä¿‚æ•°(-)

    Args:

    Returns:
      float: åœ°ä¸­ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ãŠã‚ˆã³é€æ°´æ¸©åº¦ã«é–¢ã™ã‚‹æœ€å¤§æš–æˆ¿èƒ½åŠ›ã®è£œæ­£ä¿‚æ•°(-)

    """
    return 1.35


# ============================================================================
# N.11 åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦
# ============================================================================


def get_Theta_gsRW_d_ave_d(K_gsRW_H, Theta_ex_d_Ave_d, Theta_ex_H_Ave, Theta_ex_a_Ave, Delta_Theta_gsRW_H):
    """æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦(â„ƒ) (17)

    Args:
      K_gsRW_H(float): K_gsRW_H: åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°(-)
      Theta_ex_d_Ave_d(ndarray): æ—¥ä»˜dã«ãŠã‘ã‚‹æ—¥å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      Theta_ex_H_Ave(float): æš–æˆ¿æœŸã«ãŠã‘ã‚‹æœŸé–“å¹³å‡å¤–æ°—æ¸©åº¦ï¼ˆâ„ƒï¼‰
      Theta_ex_a_Ave(float): å¹´å¹³å‡å¤–æ°—æ¸©åº¦ (â„ƒ)
      Delta_Theta_gsRW_H(float): æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰

    Returns:
      ndarray: æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦(â„ƒ)

    """
    # æ—¥ä»˜dã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æ—¥å¹³å‡æ¸©åº¦(â„ƒ) (17)
    Theta_gsRW_d_ave_d = K_gsRW_H * (Theta_ex_d_Ave_d - Theta_ex_H_Ave) + Theta_ex_a_Ave + Delta_Theta_gsRW_H

    return Theta_gsRW_d_ave_d


def calc_Delta_Theta_gsRW_H(R_L_max, HeatExchangerType):
    """æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰(18)

    Args:
      R_L_max(float): 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰
      HeatExchangerType(str): åœ°ä¸­ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—

    Returns:
      float: æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰

    """
    # ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°å–å¾—
    a_gsRW_H = get_a_gsRW_H(HeatExchangerType)
    b_gsRW_H = get_b_gsRW_H(HeatExchangerType)

    # æš–æˆ¿æœŸã«ãŠã‘ã‚‹åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´ã®æœŸé–“å¹³å‡æ¸©åº¦ã¨å¹´å¹³å‡å¤–æ°—æ¸©åº¦ã¨ã®å·®ï¼ˆâ„ƒï¼‰(18)
    Delta_Theta_gsRW_H = a_gsRW_H * R_L_max + b_gsRW_H

    return Delta_Theta_gsRW_H


def calc_K_gsRW_H(R_L_max, HeatExchangerType):
    """åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°ï¼ˆ-ï¼‰(19)

    Args:
      R_L_max(float): 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      float: åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°ï¼ˆ-ï¼‰(19)

    """
    # ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°å–å¾—
    c_gsRW_H = get_c_gsRW_H(HeatExchangerType)
    d_gsRW_H = get_d_gsRW_H(HeatExchangerType)

    # åœ°ä¸­ç†±äº¤æ›å™¨ã‹ã‚‰ã®æˆ»ã‚Šç†±æºæ°´æ¸©åº¦ã‚’æ±‚ã‚ã‚‹å¼ã®ä¿‚æ•°ï¼ˆ-ï¼‰(19)
    K_gsRW_H = c_gsRW_H * R_L_max + d_gsRW_H

    return K_gsRW_H


def get_a_gsRW_H(HeatExchangerType):
    """ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°a_gsRW_Hã®å–å¾—

    Args:
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      float: ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°a_gsRW_Hã®å–å¾—

    """

    if HeatExchangerType == '1':
        return get_table_n_3()[0][0]
    elif HeatExchangerType == '2':
        return get_table_n_3()[1][0]
    elif HeatExchangerType == '3':
        return get_table_n_3()[2][0]
    elif HeatExchangerType == '4':
        return get_table_n_3()[3][0]
    elif HeatExchangerType == '5':
        return get_table_n_3()[4][0]
    else:
        raise ValueError(HeatExchangerType)


def get_b_gsRW_H(HeatExchangerType):
    """ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°b_gsRW_Hã®å–å¾—

    Args:
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      float: ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°b_gsRW_Hã®å–å¾—

    """
    if HeatExchangerType == '1':
        return get_table_n_3()[0][1]
    elif HeatExchangerType == '2':
        return get_table_n_3()[1][1]
    elif HeatExchangerType == '3':
        return get_table_n_3()[2][1]
    elif HeatExchangerType == '4':
        return get_table_n_3()[3][1]
    elif HeatExchangerType == '5':
        return get_table_n_3()[4][1]
    else:
        raise ValueError(HeatExchangerType)


def get_c_gsRW_H(HeatExchangerType):
    """ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°a_gsRW_Hã®å–å¾—

    Args:
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      float: ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°a_gsRW_Hã®å–å¾—

    """
    if HeatExchangerType == '1':
        return get_table_n_3()[0][2]
    elif HeatExchangerType == '2':
        return get_table_n_3()[1][2]
    elif HeatExchangerType == '3':
        return get_table_n_3()[2][2]
    elif HeatExchangerType == '4':
        return get_table_n_3()[3][2]
    elif HeatExchangerType == '5':
        return get_table_n_3()[4][2]
    else:
        raise ValueError(HeatExchangerType)


def get_d_gsRW_H(HeatExchangerType):
    """ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°b_gsRW_Hã®å–å¾—

    Args:
      HeatExchangerType(str): ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ— (-)

    Returns:
      float: ç†±äº¤æ›å™¨ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸä¿‚æ•°b_gsRW_Hã®å–å¾—

    """
    if HeatExchangerType == '1':
        return get_table_n_3()[0][3]
    elif HeatExchangerType == '2':
        return get_table_n_3()[1][3]
    elif HeatExchangerType == '3':
        return get_table_n_3()[2][3]
    elif HeatExchangerType == '4':
        return get_table_n_3()[3][3]
    elif HeatExchangerType == '5':
        return get_table_n_3()[4][3]
    else:
        raise ValueError(HeatExchangerType)


def get_table_n_3():
    """è¡¨N.3 ä¿‚æ•°

    Args:

    Returns:
      list: è¡¨N.3 ä¿‚æ•°

    """
    table_n_3 = [
        (3.1672, -0.4273, -0.0444, 0.0442),
        (5.9793, -1.0687, -0.1613, 0.1047),
        (8.3652, -1.5946, -0.2486, 0.1546),
        (9.9065, -2.1827, -0.3454, 0.2072),
        (10.2898, -2.8727, -0.3270, 0.2700)
    ]
    return table_n_3


def get_R_L_max(L_max_H, L_max_C):
    """1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰(20a)

    Args:
      L_max_H(float): 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰
      L_max_C(float): 1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰

    Returns:
      float: 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰(20a)

    """
    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã¨1æ—¥å½“ãŸã‚Šã®å†·æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ã®å’Œã«å¯¾ã™ã‚‹ã€ã“ã‚Œã‚‰ã®å·®ã®æ¯”ï¼ˆ-ï¼‰(20a)
    R_L_max = (L_max_C - L_max_H) / (L_max_C + L_max_H)

    return R_L_max


def get_L_max_H(L_H_x_t_i):
    """1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20b)

    Args:
      L_H_x_t_i(ndarray): æš–å†·æˆ¿åŒºç”»iã®1æ™‚é–“å½“ãŸã‚Šã®æš–æˆ¿è² è·

    Returns:
      float: 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰

    """
    # L_H_x_t_iã¯æš–å†·æˆ¿åŒºç”»æ¯ã«365æ—¥Ã—24æ™‚é–“åˆ†ã®è² è·ã‚’æŒã£ãŸ2æ¬¡å…ƒé…åˆ—
    # æš–å†·æˆ¿åŒºç”»è»¸åˆç®—(æš–å†·æˆ¿åŒºç”»ã®æ¬¡å…ƒã‚’ãªãã™)
    L_H_x_t = np.sum(L_H_x_t_i, axis=0)

    # 1æ¬¡å…ƒé…åˆ—ã‚’2æ¬¡å…ƒé…åˆ—ã«å½¢çŠ¶å¤‰æ›ã™ã‚‹
    L_H_x_t = np.reshape(L_H_x_t, (365, 24))

    # æ™‚é–“è»¸åˆç®—
    L_H_x = np.sum(L_H_x_t, axis=1)

    # 1æ—¥å½“ãŸã‚Šã®æš–æˆ¿è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20b)
    L_max_H = np.max(L_H_x)

    return L_max_H


def get_L_max_C(L_CS_x_t_i, L_CL_x_t_i):
    """1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20c)

    Args:
      L_CS_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿é¡•ç†±è² è· (MJ/h)
      L_CL_x_t_i(ndarray): æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹æš–å†·æˆ¿åŒºç”»iã®å†·æˆ¿æ½œç†±è² è· (MJ/h)

    Returns:
      float: 1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰

    """
    # æš–å†·æˆ¿åŒºç”»è»¸åˆç®—(æš–å†·æˆ¿åŒºç”»ã®æ¬¡å…ƒã‚’ãªãã™)
    L_CS_x_t = np.sum(L_CS_x_t_i, axis=0)
    L_CL_x_t = np.sum(L_CL_x_t_i, axis=0)

    # L_CS_x_tã¨L_CL_x_tã®è¦ç´ åŒå£«ã‚’è¶³ã™
    L_C_x_t = L_CS_x_t + L_CL_x_t

    # 1æ¬¡å…ƒé…åˆ—ã‚’2æ¬¡å…ƒé…åˆ—ã«å½¢çŠ¶å¤‰æ›ã™ã‚‹
    L_C_x_t = np.reshape(L_C_x_t, (365, 24))

    # æ™‚é–“è»¸åˆç®—
    L_C_x = np.sum(L_C_x_t, axis=1)

    # 1æ—¥å½“ãŸã‚Šã®å†·æˆ¿å…¨ç†±è² è·ã®å¹´é–“æœ€å¤§å€¤ï¼ˆMJ/dï¼‰(20c)
    L_max_C = np.max(L_C_x)

    return L_max_C
